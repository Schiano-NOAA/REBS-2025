<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="02_introduction_files/libs/clipboard/clipboard.min.js"></script>
<script src="02_introduction_files/libs/quarto-html/quarto.js"></script>
<script src="02_introduction_files/libs/quarto-html/popper.min.js"></script>
<script src="02_introduction_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="02_introduction_files/libs/quarto-html/anchor.min.js"></script>
<link href="02_introduction_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02_introduction_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="02_introduction_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="02_introduction_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="02_introduction_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Rougheye (<em>Sebastes aleutianus</em>) and Blackspotted (<em>Sebastes melanostictus</em>) rockfishes are two species that form one management complex.</p>
<p>Rougheye rockfish are a long-lived rockfish named after a series of 2-10 spines along the lower rim of their eyes. They have also been called blackthroat or blacktip rockfish <span class="citation" data-cites="love_rockfishes_2002">[@love_rockfishes_2002, @love_certainly_2011]</span>. Blackspotted rockfish are distributed in similar locations as rougheye rockfish and it is very difficult to visually distinguish the two species. These two species may hybridize on occasion <span class="citation" data-cites="love_certainly_2011">[@love_certainly_2011]</span>.</p>
<p>It has only been from recent genetic studies that these two separate species have been identified <span class="citation" data-cites="gharrett_genetically_2006">[@gharrett_genetically_2006, @hawkins_genetic_2005]</span> and have had phenotypic characteristics useful for identifying the species in the field identified <span class="citation" data-cites="gharrett_genetically_2006">[@gharrett_genetically_2006, @orr_species_2008]</span>. Before then, data are available for one species called Rougheye Rockfish which included Rougheye Rockfish and Blackspotted Rockfish. Due to the difficulty in distinguishing these two species and the lack of historical separation of the species in all of the data, this assessment combines any data for Blackspotted Rockfish with Rougheye Rockfish into <code>r Spp</code> and provides management advice for the two species combined. These species are also closely related to Shortraker Rockfish (<em>Sebastes borealis</em>) and are sometimes difficult to distinguish from Shortraker Rockfish without looking at the gill rakers.</p>
<section id="stock-structure" class="level2">
<h2 class="anchored" data-anchor-id="stock-structure">Stock Structure</h2>
<p>There are at least two questions to think about when considering stock structure for <code>r Spp</code> when doing a stock assessment.</p>
<ul>
<li>Since Rougheye and Blackspotted Rockfishes are two different species, can they be separated as two stocks and conduct separate assessments?</li>
</ul>
<p>Rougheye rockfish were first described in 1811 as <em>Perca variabilis</em> by German zoologist Peter Simon Pallas <span class="citation" data-cites="jordan_fishes_1898">[@jordan_fishes_1898]</span>, and assigned to various taxa at least 15 times since <span class="citation" data-cites="love_rockfishes_2002">[@love_rockfishes_2002]</span>. Some descriptions noted both light and dark color morphs, which, along with possible confusion with several morphologically similar co-occurring species (e.g., <em>Sebastes borealis</em> and <em>Sebastes melanostomus</em>) have contributed to the persistent ambiguity in formal descriptions of Rougheye Rockfish <span class="citation" data-cites="orr_species_2008">[@orr_species_2008]</span>. The first genetic studies conducted in the late 1960s and early 1970s <span class="citation" data-cites="tsuyuki_contribution_1968 tsuyuki_analyses_1970">[@tsuyuki_contribution_1968; @tsuyuki_analyses_1970]</span> observed diversity suggestive of two genetic types within specimens identified as Rougheye Rockfish. Allozyme studies conducted over the next two decades <span class="citation" data-cites="seeb_biochemical_1986 hawkins_genetic_1997 hawkins_genetic_2005">[@seeb_biochemical_1986; @hawkins_genetic_1997; @hawkins_genetic_2005]</span> provided additional evidence suggesting two separate genetic types within field-identified Rougheye Rockfish. Genetic variation between the two types, supported by both nuclear and mitochondrial DNA, was determined to be sufficiently conclusive to separate two species: “Type I” and “Type II” Rougheye Rockfish <span class="citation" data-cites="gharrett_two_2005">[@gharrett_two_2005]</span>. Meristic and morphometric comparisons of the two species suggested certain characters, such as gill raker counts and length, snout length, anal base length, and pectoral fin base, were significantly different, and in combination could reliably, though not definitively, distinguish between the species <span class="citation" data-cites="gharrett_genetically_2006">[@gharrett_genetically_2006]</span>. The two separate species were formally re-described by <span class="citation" data-cites="orr_species_2008">@orr_species_2008</span> with the Type II group retaining <em>Sebastes aleutianus</em> and the common name Rougheye Rockfish. Blackspotted Rockfish was proposed as the common name for the Type I group along with the scientific name of <em>Sebastes melanostictus</em>, re-establishing nomenclature from one of the species complex’s earlier descriptions <span class="citation" data-cites="matsubara_1934">[@matsubara_1934]</span>.</p>
<p>These two species remain difficult to consistently differentiate visually in the catch, thus are still commonly reported and treated as a species complex. Otolith morphometrics (e.g., shape, size, weight) have shown some promise in possibly identifying these species in Alaskan waters (97.3% Blackspotted and 86.2% of Rougheye rockfishes were accurately identified) and possibly using older otoliths to break out historical information by species <span class="citation" data-cites="harris_using_2019">[@harris_using_2019]</span>. Frey et al.&nbsp;(in prep.) provided insight into the ability of the Northwest Fisheries Science Center West Coast Groundfish Bottom Trawl Survey biologists to identify the two species, with 90% of genetically identified Rougheye rockfish being correctly identified in the field. When mis-identifications occurred, it was usually a Blackspotted rockfish being mis-identified as a Rougheye rockfish. There were few mis-identifications when a fish was identified as a Blackspotted rockfish. While this is promising for potential future species-specific data coming from the survey, it does not alleviate the historical problem of separating fishery data into the two species. Frey et al.&nbsp;(in prep.) therefore also considered whether ecological factors like depth or latitude could help separate samples by species. They found that both species occur within the range of this assessment’s considered areas (California to Washington), and heavily spatially overlap. Interestingly, there seem to be relative hot spots for these species where one species is more common than the other, and in general, Rougheye Rockfish seems to be more common than Blackspotted Rockfish (however, Blackspotted Rockfish may be the more common of the two in parts of Alaska; <span class="citation" data-cites="gharrett_two_2005">@gharrett_two_2005</span>; <span class="citation" data-cites="hawkins_genetic_2005">@hawkins_genetic_2005</span>; <span class="citation" data-cites="orr_species_2008">@orr_species_2008</span>).</p>
<p>Despite recent advances in species identification of<code>r Spp</code> as genetically distinct species, there is little ability to separate current or historical fishery data reliably in order to separate these two species into two stocks. Therefore, this assessment maintains a species complex approach, though given absolute presence off the U.S. West Coast, this may be considered more of a Rougheye than Blackspotted Rockfish stock assessment. We also note that throughout the range of these stocks, all current assessments to this point have maintained a species complex approach. While we treat these species as one assessed stock complex, we recognize and are mindful of the above species distinctions as we conduct our analyses.</p>
<ul>
<li>Both species range into Canada and Alaska – are they one stock?</li>
</ul>
<p>While genetics studies have focused mostly on identification of the two species, little is known about the population structure of either species. This assessment and the 2013 assessment <span class="citation" data-cites="hicks_status_2013">[@hicks_status_2013]</span> represent the most southerly range of these species. Comparing the absolute abundance of the 2013 assessment to the most current estimates of the Alaskan stocks, the absolute number in this southerly range is much smaller than in the Gulf of Alaska (GOA), but higher than in the Bering Sea/Aleutian Island (BSAI) stock (<strong>?@fig-SO_comp</strong>). The two smaller stocks have similar trend of decline and stabilization, whereas the higher biomass GOA stock looks to have not dropped at all over the time period considered (<strong>?@fig-RSS_comp</strong>). We assume here that the west coast stocks of <code>r Spp</code> are distinct management units from those in Alaska.</p>
</section>
<section id="distribution" class="level2">
<h2 class="anchored" data-anchor-id="distribution">Distribution</h2>
<p><code>r Spp</code> range from northern California up to and throughout Alaska and into Japan <span class="citation" data-cites="gharrett_two_2005 hawkins_genetic_2005 orr_species_2008">[@gharrett_two_2005; @hawkins_genetic_2005; @orr_species_2008]</span>. Both are long-lived (&gt;100 years), with Rougheye Rockfish having the distinction of the oldest ever aged <em>Sebastes</em> species at 205 years old. They both greatly overlap in latitude and depth (shallower than 100 m to at least 439 m), and are generally considered slope rockfish, with an ontogenetic shift from shallower to deeper, and adults commonly found at 360 m (around 200 fathoms). Rougheye seems to be proportionally more abundant when survey samples are genetically identified, and Blackspotted Rockfish tend to be found, on average, deeper than Rougheye Rockfish <span class="citation" data-cites="hawkins_genetic_2005 orr_species_2008">[@hawkins_genetic_2005; @orr_species_2008]</span>.</p>
<p><code>r Spp</code> are often associated with structure, such as hard, rocky bottoms and steep habitats. They are rarely found on the deep flats. They can be found alone or in aggregations <span class="citation" data-cites="love_rockfishes_2002">[@love_rockfishes_2002]</span>, with aggregations often differentiated by age. Younger fish may school and are often found in shallower waters on the shelf, junveiles and subadults can be found together, and larger fish may form larger aggregations in the Pacific Northwest during the autumn and winter. These two species may also hybridize on occasion <span class="citation" data-cites="love_certainly_2011">[@love_certainly_2011]</span>. These species are closely related to Shortraker Rockfish (<em>S. borealis</em>) and are sometimes difficult to distinguish from Shortraker Rockfish without looking at the gill rakers. One major distinguishing feature of Rougheye Rockfish are the 2–10 spines along the lower rim of their eyes, hence the common name “rougheye”.</p>
</section>
<section id="a-map-showing-the-scope-of-the-assessment" class="level2">
<h2 class="anchored" data-anchor-id="a-map-showing-the-scope-of-the-assessment">A Map Showing the Scope of the Assessment</h2>
<p>This assessment treats the U.S. <code>r Spp</code> resource from the Mexican border to the Canadian border as a single coastwide stock (<strong>?@fig-map</strong>). The U.S.-Canadian border is the northern boundary for the assessed stock, although the basis for this choice is due to political and current management needs rather than the population dynamics The assessment excludes consideration of the Puget Sound and Salish Sea.</p>
</section>
<section id="life-history" class="level2">
<h2 class="anchored" data-anchor-id="life-history">Life History</h2>
<p>Like all <em>Sebastes</em> species, <code>r Spp</code> give birth to live young. Larvae released has been documented between February and June and extrusion lengths are between 4.5-5.3 mm <span class="citation" data-cites="love_rockfishes_2002">[@love_rockfishes_2002]</span>. <span class="citation" data-cites="dick_meta-analysis_2017">@dick_meta-analysis_2017</span> showed that rockfishes exhibit a non-proportional relationship of fecundity to weight, with larger individuals producing more eggs than expected only by weight. Although Neither Rougheye or Blackspotted Rockfishes have a species- or subfamily-specific estimate for this relationship, this stock assessment uses the unobserved Genus Sebastes values to inform fecundity to weight relationship for <code>r Spp</code>.</p>
<p>A wide range of prey items make up the diet of <code>r Spp</code>. Crangid and pandalid shrimps make up the majority of their diets, and larger individuals, greater than 30 cm, feeding upon other fishes <span class="citation" data-cites="love_certainly_2011">[@love_certainly_2011]</span>. They are also known to feed upon gammarid amphipods; mysids, crabs, polychaetes, and octopuses <span class="citation" data-cites="love_rockfishes_2002 love_certainly_2011">[@love_rockfishes_2002; @love_certainly_2011]</span>.</p>
</section>
<section id="ecosystem-considerations" class="level2">
<h2 class="anchored" data-anchor-id="ecosystem-considerations">Ecosystem Considerations</h2>
</section>
<section id="historical-and-current-fishery-information" class="level2">
<h2 class="anchored" data-anchor-id="historical-and-current-fishery-information">Historical and Current Fishery Information</h2>
<p><code>r Spp</code> are not targeted by a specific fishery, but are desirable and marketable, thus are typically retained when captured. They are often caught in bottom trawl, mid-water trawl, and longline fisheries. Small numbers have been observed in pot, shrimp, and recreational fisheries.</p>
<p>Longline catches of <code>r Spp</code> are present from the turn of the century and continue in recent years, targeting sablefish and halibut.</p>
<p>After many attempts to start trawl fisheries off the west coast of the United States in the late 1800’s, the availability of the otter trawl and the diesel engine in the mid-1920’s helped the trawl fisheries expand <span class="citation" data-cites="douglas_species_1998">[@douglas_species_1998]</span>. The trawl fisheries became established during World War II when demand increased for bottomfish. A mink food fishery also developed during World War II <span class="citation" data-cites="jones_oregon_1961">[@jones_oregon_1961]</span>, and post-war catches for rockfishes, including <code>r Spp</code>, increased <span class="citation" data-cites="niska_species_1976">[@niska_species_1976]</span>. Between mid-1960s and mid-1970s, foreign trawl fleets from the former Soviet Union, Japan, Poland, Bulgaria and East Germany targeted aggregations of Pacific ocean perch in the Northeast Pacific Ocean, in the waters off the U.S. West Coast <span class="citation" data-cites="love_rockfishes_2002">[@love_rockfishes_2002]</span>, until the EEZ was implemented in 1977 <span class="citation" data-cites="rogers_species_2003">[@rogers_species_2003]</span>.</p>
<p>Also, large-scale harvesting of Pacific hake in the United States began in late-1960s, when factory trawlers from the Soviet Union and other countries began targeting this stock. After the 200-mile U.S. <code>r Spp</code> is commonly caught in this fishery. Exclusive Economic Zone was declared in 1977, a Joint-Venture fishery was initiated between United States trawlers and Soviet factory trawlers acting as mother-ships (larger, slower ships for fish processing and storage while at sea). By 1989 the U.S. fleet capacity had grown to a level sufficient to harvest the entire quota, and no further foreign fishing was allowed.</p>
<p>Since 1977, landings of rockfish were higher until management restrictions were implemented in 2000. <code>r Spp</code> inhabit deeper water as adults, which were fished less often historically. More detailed information of the fisheries by state is given in <strong>?@sec-fishery_data</strong>, where the reconstructed catches are discussed. The catches by state in fleets as well as for the Pacific whiting at-sea fleet are shown in <strong>?@fig-landings</strong>.</p>
</section>
<section id="summary-of-management-history-and-management-performance" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-management-history-and-management-performance">Summary of Management History and Management Performance</h2>
<p><code>r spp</code> has been a small component of groundfish fisheries and catches of <code>r Spp</code> have been governed by restrictions on assemblages of species, of which these species are a member. However, the distribution of fishing effort in areas where <code>r Spp</code> might be encountered has also been affected by catch restrictions on co-occurring, rebuilding species, as well as associated area closures instituted to promote rebuilding. The first imposed landings limits on a coastwide Sebastes complex (<code>r Spp</code> being one of the 50 rockfishes in the complex) were instituted in 1983.</p>
<p>This complex was divided in to two management areas north and south of 43º00’ N in 1994. Ongoing concern that shelf and slope rockfishes may be undergoing overfishing led the attempt by <span class="citation" data-cites="rogers_status_1996">@rogers_status_1996</span> to describe the status of most rockfishes in the Sebastes complex. <code>r Spp</code> information content was low. To estinated exploitation rates of Rougheye Rockfish <span class="citation" data-cites="rogers_status_1996">@rogers_status_1996</span> assumed fishing mortality being to equal to natural mortality and used AFSC/NWFSC Triennial Shelf Survey to calculate an average biomass. The analysis found that the stock was undergoing very high exploitation rates in both management areas.</p>
<p>The dividing line between the northern and southern management areas was shifted to 40º10’ N latitude in 1999 and the Sebastes complex was subsequently divided into nearshore, shelf, and slope complexes in 2000. Rougheye Rockfish has been managed under trip limits for the minor slope rockfish complex in both north and south management areas since this time.</p>
<p>Table <strong>?@tbl-management_summary</strong> summarizes major management changes since 2000. Some important changes include the implementation of Rockfish Conservation Areas (RCA’s) in 2002, the beginning of trawl rationalization in 2011, and the lifting of the RCAs beginning in 2020 with the removal of the trawl RCA in Oregon and California and loosening restrictions in the non-trawl RCAs in 2023 and 2024.</p>
<p>Though managed as part of a complex, OFL contributions for <code>r spp</code> were calculated using DB-SRA in 2010 for the 2011-2012 management cycle. This lead to the observation that recent catches had frequently exceeded the OFL contribution estimated using data-poor, catch-only methods provided a strong indication that a more thorough evaluation of <code>r Spp</code> stock status and sustainable harvest levels be undertaken, using all available data. A full assessment of <code>r spp</code> was undertaken in 2013 and indicated the stock complex was above management target levels (<span class="citation" data-cites="hicks_status_2013">@hicks_status_2013</span>). Recent management performance for <code>r spp</code> as a part of the nothern minor slope rockfish complex is provided in Table <span class="citation" data-cites="managment-performance">@managment-performance</span> (ALI IS STILL CREATING THIS TABLE - WILL ADD TEXT FOR IT LATER).</p>
<!-- Management performance, including a table or tables comparing Overfishing Limit (OFL), Acceptable Biological Catch (ABC), Annual Catch Limit (ACL), landings, and catch (i.e., landings plus discard) for each area and year. Groundfish assessments that estimate dead discarded catch must include a disclaimer noting that total mortality estimates from the WCGOP and from the stock assessment may differ due to the use of different methods. Investigation into how these methods differ is beyond the scope of a benchmark assessment. The rationale for modeling discard mortality can also be provided. This should be included in all update assessments.  -->
</section>
<section id="fisheries-off-canada-and-alaska" class="level2">
<h2 class="anchored" data-anchor-id="fisheries-off-canada-and-alaska">Fisheries off Canada and Alaska</h2>
<p><code>r spp</code> are distributed throughout Canada and Alaska and are commonly caught in trawl and longline fisheries. Alaska conducts assessments biennially for the Rougheye/Blackspotted complex, and two have been recently done: one for the Bering Sea and Aluetian Islands <span class="citation" data-cites="spencer_assessment_2023">[@spencer_assessment_2023]</span> and the other for the Gulf of Alaska <span class="citation" data-cites="sullivan_assessment_2023">[@sullivan_assessment_2023]</span>. Canada completed an assessment in 2020 <span class="citation" data-cites="starr_rougheyeblackspotted_2020">[@starr_rougheyeblackspotted_2020]</span>. The fisheries and assessments for each country are described below.</p>
<p>Rougheye rockfish have been managed as a bycatch only species in Alaska since 1991 with catches ranging between 130 and 2,418 mt and peaking in the late 1980s and early 1990s <span class="citation" data-cites="sullivan_assessment_2023">[@sullivan_assessment_2023]</span>. Generally, about 55-75% of the catch are trawl-caught and 30-45% from hook-and-line (mainly, longline) fisheries. Since 2017 the move to pot gear in the sablefish fishery has decreased the longline catches. Discards since 2013 have ranged from 11.6% (in 2023) and 45% (in 2018). The Rougheye/Blackspotted complex catch levels generally are between 20% and 60% of the Total Allowable Catch since the 2005 when the complex began to be managed separately. The most recent age-structured integrated stock assessments of this complex in the Bering Sea and Aluetian Islands <span class="citation" data-cites="spencer_assessment_2023">[@spencer_assessment_2023]</span> and for the Gulf of Alaska <span class="citation" data-cites="sullivan_assessment_2023">[@sullivan_assessment_2023]</span> do not indicate either overfishing or the stocks being overfished.</p>
<p>Canada identified two species of Rougheye Rockfish (Type I and Type II) in 2007 and designated both species of special concern, which means that they may become threatened or endangered because of a combination of biological characteristics and identified threats <span class="citation" data-cites="cosewic_2007">[@cosewic_2007]</span>. This designation was given because biomass estimates are uncertain and no strong trends are observed, there is evidence of truncation of the age distribution and overall mortality has doubled, it is a long-lived, low-fecundity Sebastes species, which is susceptible to population collapse and slow recovery, and because the difficulty in separating the two species may result in potential impacts on one of the species going unnoticed. Subsequently, the species were identified as rougheye rockfish and blackspotted rockfish and a management plan was created in 2012 with a goal of sustaining the populations of rougheye and blackspotted rockfishes <span class="citation" data-cites="fisheries_and_oceans_canada_management_2012">[@fisheries_and_oceans_canada_management_2012]</span>. Five high priority and seven low priority actions have been identified to address the threats to the populations and support the management goal.</p>
<p>The first Canadian stock assessment for these species, using a integrated catch-at-age model, was conducted in 2022 to estimated stock status of two Rougheye/Blackspotted (REBS) rockfishes management units (REBS north and REBS south) a the beginning of 2021. The REBS north stock was in the healthy zone in the reference model. The REBS south stock was likely in the healthy zone, but with an elevated possibility of being in the cautious zone.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>